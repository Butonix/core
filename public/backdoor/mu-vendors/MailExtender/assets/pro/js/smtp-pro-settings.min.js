var WPMailSMTP=window.WPMailSMTP||{};WPMailSMTP.Admin=WPMailSMTP.Admin||{},WPMailSMTP.Admin.Settings=WPMailSMTP.Admin.Settings||{},WPMailSMTP.Admin.Settings.Pro=WPMailSMTP.Admin.Settings.Pro||function(e,s,n){"use strict";var o=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},l={init:function(){n(e).ready(l.ready)},ready:function(){l.pageHolder=n(".wp-mail-smtp-tab-settings"),l.bindActions()},bindActions:function(){l.license.bindActions(),l.amazonses.bindActions()},license:{getNoticeHtml:function(e,s){return'<div class="notice '+e+' wp-mail-smtp-license-notice is-dismissible"><p>'+s+"</p>"},bindActions:function(){l.pageHolder.on("click","#wp-mail-smtp-setting-license-key-verify",this.verify),l.pageHolder.on("click","#wp-mail-smtp-setting-license-key-deactivate",this.deactivate),l.pageHolder.on("click","#wp-mail-smtp-setting-license-key-refresh",this.refresh)},verify:function(e){var a=jQuery(e.target),i=a.closest(".wp-mail-smtp-setting-row"),s={action:"wp_mail_smtp_pro_license_ajax",task:"license_verify",nonce:n("#wp-mail-smtp-setting-license-nonce",i).val(),license:n("#wp-mail-smtp-setting-license-key",i).val()};a.prop("disabled",!0),n.post(ajaxurl,s,function(e){var s,t;e.success?(s=e.data.message,t="notice-success",i.find(".type, .desc, #wp-mail-smtp-setting-license-key-deactivate").show(),i.find(".type strong").text(e.data.type)):(s=e.data,t="notice-error",i.find(".type, .desc, #wp-mail-smtp-setting-license-key-deactivate").hide()),n(".wp-mail-smtp-license-notice",l.pageHolder).remove(),l.pageHolder.find("h1").after(l.license.getNoticeHtml(t,s)),a.prop("disabled",!1)}).fail(function(e){console.log(e.responseText)})},deactivate:function(e){var a=jQuery(e.target),i=a.closest(".wp-mail-smtp-setting-row"),s={action:"wp_mail_smtp_pro_license_ajax",task:"license_deactivate",nonce:n("#wp-mail-smtp-setting-license-nonce",i).val()};a.prop("disabled",!0),n.post(ajaxurl,s,function(e){var s,t=e.data;e.success?(s="notice-success",i.find("#wp-mail-smtp-setting-license-key").val(""),i.find(".type strong").text("lite"),i.find(".desc, #wp-mail-smtp-setting-license-key-deactivate").hide()):s="notice-error",n(".wp-mail-smtp-license-notice",l.pageHolder).remove(),l.pageHolder.find("h1").after(l.license.getNoticeHtml(s,t)),a.prop("disabled",!1)}).fail(function(e){console.log(e.responseText)})},refresh:function(e){e.preventDefault();var a=jQuery(e.target),i=a.closest(".wp-mail-smtp-setting-row"),s={action:"wp_mail_smtp_pro_license_ajax",task:"license_refresh",nonce:n("#wp-mail-smtp-setting-license-nonce",i).val()};a.prop("disabled",!0),n.post(ajaxurl,s,function(e){var s,t;e.success?(s=e.data.message,t="notice-success",i.find(".type strong").text(e.data.type)):(s=e.data,t="notice-error",i.find(".desc, #wp-mail-smtp-setting-license-key-deactivate").hide()),n(".wp-mail-smtp-license-notice",l.pageHolder).remove(),l.pageHolder.find("h1").after(l.license.getNoticeHtml(t,s)),a.prop("disabled",!1)}).fail(function(e){console.log(e.responseText)})}},amazonses:{bindActions:function(){jQuery(".js-wp-mail-smtp-providers-amazonses-email-add").on("click",this.processEmailAdd),l.pageHolder.on("click",".js-wp-mail-smtp-providers-amazonses-email-delete",this.processEmailDelete),l.pageHolder.on("click",".js-wp-mail-smtp-providers-amazonses-email-resend",this.processEmailResend),l.pageHolder.on("click",".js-wp-mail-smtp-providers-amazonses-email-resend-delete",this.processEmailResendDelete)},processEmailAdd:function(e){e.preventDefault();var s=jQuery(e.target),t=s.siblings('input[type="email"]'),a=t.val(),i=s.siblings('input[name="wp_mail_smtp_pro_amazonses_email_add"]').val(),n=jQuery("#wp-mail-smtp-providers-amazonses-email-enter");return!s.hasClass("disabled")&&(o(a)?void(a.length&&i.length&&jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"wp_mail_smtp_pro_providers_ajax",task:"email_add",mailer:"amazonses",email:a,nonce:i},beforeSend:function(){n.find("p.response").remove(),s.addClass("disabled")}}).done(function(e){var s="response";s+=e.hasOwnProperty("success")&&e.success?" success":" error",e.hasOwnProperty("success")&&e.success&&t.val(""),n.append('<p class="'+s+'">'+e.data+"</p>")}).fail(function(){n.append('<p class="response error">'+wp_mail_smtp_pro.ses_text_smth_wrong+"</p>")}).complete(function(){s.removeClass("disabled")})):(n.find("p.response").remove(),n.append('<p class="response error">'+wp_mail_smtp_pro.ses_text_email_invalid+"</p>"),!1))},processEmailDelete:function(e){if(e.preventDefault(),!confirm(wp_mail_smtp_pro.ses_text_email_delete))return!1;var s=jQuery(e.target).closest("a"),t=s.data("email"),a=s.data("nonce").toString();return!s.hasClass("disabled")&&(o(t)?void(t.length&&a.length&&jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"wp_mail_smtp_pro_providers_ajax",task:"email_delete",mailer:"amazonses",email:t,nonce:a},beforeSend:function(){s.addClass("disabled")}}).done(function(e){e.hasOwnProperty("success")&&e.success?s.closest("tr").fadeOut("fast",function(){this.remove()}):alert(e.data)}).fail(function(){alert(wp_mail_smtp_pro.ses_text_smth_wrong)}).complete(function(){s.removeClass("disabled")})):(alert(wp_mail_smtp_pro.ses_text_smth_wrong),!1))},processEmailResend:function(e){e.preventDefault();var s=jQuery(e.target).closest("a"),t=s.data("email"),a=s.data("nonce").toString();return!s.hasClass("disabled")&&(o(t)?void(t.length&&a.length&&jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"wp_mail_smtp_pro_providers_ajax",task:"email_add",mailer:"amazonses",email:t,nonce:a},beforeSend:function(){s.addClass("disabled"),s.text(wp_mail_smtp_pro.ses_text_sending)}}).done(function(e){e.hasOwnProperty("success")&&e.success&&s.html('<span class="dashicons dashicons-yes"></span> '+wp_mail_smtp_pro.ses_text_sent).fadeOut(1e3,function(){jQuery(this).text(wp_mail_smtp_pro.ses_text_resend),jQuery(this).fadeIn("fast")})}).fail(function(){alert(wp_mail_smtp_pro.ses_text_smth_wrong)}).complete(function(){s.removeClass("disabled")})):(alert(wp_mail_smtp_pro.ses_text_smth_wrong),!1))},processEmailResendDelete:function(e){if(e.preventDefault(),!confirm(wp_mail_smtp_pro.ses_text_email_delete))return!1;var s=jQuery(e.target).closest("a"),t=s.data("email"),a=s.data("nonce").toString();return!s.hasClass("disabled")&&(o(t)?void(t.length&&a.length&&jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"wp_mail_smtp_pro_providers_ajax",task:"email_resend_delete",mailer:"amazonses",email:t,nonce:a},beforeSend:function(){s.addClass("disabled")}}).done(function(e){e.hasOwnProperty("success")&&e.success?s.closest("tr").fadeOut("fast",function(){this.remove()}):alert(e.data)}).fail(function(){alert(wp_mail_smtp_pro.ses_text_smth_wrong)}).complete(function(){s.removeClass("disabled")})):(alert(wp_mail_smtp_pro.ses_text_smth_wrong),!1))},closeEmailAddPopup:function(){jQuery("#TB_closeWindowButton").click()}}};return l}(document,window,jQuery),WPMailSMTP.Admin.Settings.Pro.init();